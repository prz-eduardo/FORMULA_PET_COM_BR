<a class="p-card" [class.has-discount]="product.promoPrice != null || (product.discount && product.discount > 0)" [routerLink]="['/produto', product.id]" [queryParams]="{ src: 'loja' }">
  <div class="thumb">
  <img [src]="product.image" [alt]="product.name" title="{{ product.name }}" width="320" height="200" loading="lazy" decoding="async" />
    <div class="badge" *ngIf="product.discount && product.discount > 0">-{{ product.discount | number:'1.0-0' }}%</div>
    <button class="fav" *ngIf="supportsFavorites" (click)="onFavClick($event)" [attr.aria-pressed]="favoriteActive ?? product.isFavorited">
      <span class="heart">{{ (favoriteActive ?? product.isFavorited) ? '‚ù§Ô∏è' : 'ü§ç' }}</span>
      <span class="count" *ngIf="product.favoritesCount != null">{{ product.favoritesCount }}</span>
    </button>
    <button class="add" (click)="onAddClick($event)" title="Adicionar ao carrinho">üõí</button>
  </div>
  <div class="info">
    <h3 class="nome" [title]="product.name">{{ product.name }}</h3>
    <div class="linha">
      <div class="categoria" *ngIf="product.category">{{ product.category }}</div>
      <div class="rating" *ngIf="supportsRatings && product.ratingsCount && product.ratingsCount > 0">
        <span class="stars">
          <ng-container *ngFor="let s of stars; let i = index">
            <span class="star">{{ i + 1 <= ratingValue ? '‚òÖ' : '‚òÜ' }}</span>
          </ng-container>
        </span>
        <span class="r-val">{{ ratingValue | number:'1.1-1' }}</span>
        <span class="r-total">({{ product.ratingsCount }})</span>
      </div>
    </div>
    <div class="tags" *ngIf="product.tags?.length">
      <span class="tag" *ngFor="let t of (product.tags | slice:0:2)">{{ t }}</span>
      <span class="tag more" *ngIf="(product.tags?.length || 0) > 2">+{{ (product.tags?.length || 0) - 2 }}</span>
    </div>
    <p class="desc" *ngIf="product.description">{{ product.description }}</p>
    <div class="preco">
      <span class="atual">{{ priceNow | currency:'BRL' }}</span>
      <span class="old" *ngIf="showOldPrice">{{ product.price | currency:'BRL' }}</span>
      <span class="old placeholder" *ngIf="!showOldPrice" aria-hidden="true">{{ product.price | currency:'BRL' }}</span>
    </div>
  </div>
</a>
