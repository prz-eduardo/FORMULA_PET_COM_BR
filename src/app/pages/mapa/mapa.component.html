<app-navmenu></app-navmenu>
<div style="height: 60px;"></div>
<main class="mapa-container container">
  <header class="mapa-header">
  <h1 class="mapa-title">Mapa <span class="emoji">üó∫Ô∏è</span></h1>
    <p class="mapa-subtitle">Encontre servi√ßos pet pr√≥ximos: veterin√°rios, dog walkers, petsitters e creches caninas.</p>
    <section class="farmacia-info" role="region" aria-label="Localiza√ß√£o da farm√°cia">
      <h2 class="farmacia-title">Nossa Farm√°cia</h2>
      <p class="farmacia-address">Rua Treze de Maio, 506, Conjunto 04, S√£o Francisco, Curitiba - PR, CEP 80510-030</p>
      <p class="farmacia-directions">
        <button
          type="button"
          class="farmacia-center-btn btn primary"
          aria-label="Centralizar mapa na localiza√ß√£o da farm√°cia"
          title="Centralizar mapa"
          (click)="centerOnPharmacy()">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
        <path d="M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7z" fill="currentColor"/>
        <circle cx="12" cy="9" r="2.5" fill="#fff" />
          </svg>
          Centralizar no mapa
        </button>
      </p>
    </section>
  </header>

  <div class="map-layout">
    <aside class="map-sidebar neumorph-card">
      <nav class="service-tabs" role="tablist" aria-label="Servi√ßos">
  <button *ngFor="let t of tabs"
    (click)="select(t.id)"
    [class.active]="active===t.id"
    role="tab"
    [attr.aria-selected]="(active===t.id) ? 'true' : 'false'"
    [attr.aria-controls]="'panel-' + t.id">
          {{ t.label }}
        </button>
      </nav>

      <div class="filters" role="region" [attr.aria-labelledby]="'filters-' + active">
        <h4 [attr.id]="'filters-' + active">Filtros ‚Äî {{ getActiveLabel() }}</h4>
        <div class="filter-list" id="panel-{{active}}">
          <ng-container *ngIf="getFiltersForActive().length; else noFilters">
            <button class="filter-chip" *ngFor="let f of getFiltersForActive()" (click)="toggleFilter(f)" [class.on]="f.on">{{ f.label }}</button>
          </ng-container>
          <ng-template #noFilters>
            <div class="no-filters">Nenhum filtro dispon√≠vel para este servi√ßo.</div>
          </ng-template>
        </div>
      </div>

      <div class="results">
        <h4>Resultados</h4>
        <div *ngIf="loading">Carregando parceiros...</div>
        <div *ngIf="error" class="error">{{ error }}</div>

        <ul *ngIf="!loading && partners?.length">
          <li *ngFor="let p of partners" class="result-item" role="button" tabindex="0" (click)="centerOnPartner(p)" (keyup.enter)="centerOnPartner(p)" [attr.aria-label]="'Centralizar ' + (p.nome || p.name || 'parceiro') + ' no mapa'">
            <div class="result-thumb" aria-hidden="true"></div>
            <div class="result-body">
              <div class="result-title">{{ p.nome || p.name || 'Parceiro' }}</div>
              <div class="result-meta">{{ p.telefone || p.phone || '' }} {{ p.email ? '¬∑ ' + p.email : '' }}</div>
            </div>
          </li>
        </ul>

        <div *ngIf="!loading && !partners?.length">Nenhum parceiro encontrado.</div>
      </div>
    </aside>

    <section class="map-area">
      <div class="map-frame-wrap">
        <!-- Google Map container: initialized dynamically in the component when Maps API key is available -->
        <div id="gmap" class="gmap" role="region" aria-label="Mapa de parceiros"></div>
        <!-- fallback handled programmatically; noscript iframe removed to avoid hydration mismatches -->
      </div>
    </section>
  </div>
</main>
<app-footer></app-footer>
