<app-navmenu *ngIf="!modal"></app-navmenu>

<div class="area-like-wrapper pets-area">
  <main class="container">
    <div class="top-actions" *ngIf="!modal">
      <button class="btn-back" (click)="voltar()">← Voltar</button>
    </div>
    <h1 class="titulo" *ngIf="!modal">Meus Pets</h1>

    <div *ngIf="carregando" class="card">Carregando...</div>

    <div *ngIf="!carregando && !pets.length" class="card vazio">
      <p>Você ainda não cadastrou nenhum pet.</p>
      <a class="btn" routerLink="/novo-pet">Cadastrar Pet</a>
    </div>

    <section *ngIf="!carregando && pets.length" class="pet-list">
      <article class="pet-card card photo-card" *ngFor="let p of pets">
        <div class="photo-bg">
          <img class="photo-img" [src]="p.photoURL || '/imagens/image.png'" (error)="onImgError($event)" [attr.alt]="p.nome || 'Pet'" />
            <div class="top-overlay">
              <h2 class="pet-title pf-poppins" [class.long]="p.nome && p.nome.length > 18">{{ p.nome }}</h2>
              <div class="species-rows">
                <div class="species">{{ p.especie }}</div>
                <div class="raca" *ngIf="p.raca">{{ p.raca }}</div>
              </div>
            </div>
            <div class="overlay">
              <div class="meta-right">
                <div class="badges">
                  <span class="badge sexo" *ngIf="p.sexo">{{ p.sexo === 'F' || p.sexo === 'Fêmea' ? '♀' : (p.sexo === 'M' || p.sexo === 'Macho' ? '♂' : p.sexo) }}</span>
                  <span class="badge peso" *ngIf="p.pesoKg">{{ p.pesoKg | number:'1.2-2' }} kg</span>
                  <span class="badge" *ngIf="p.idadeAnos">{{ p.idadeAnos }} anos</span>
                </div>
              </div>
            </div>
        </div>

  <a class="edit-fab" [routerLink]="p.id ? ['/editar-pet', p.id] : null" [class.disabled]="!p.id" [attr.aria-label]="'Editar ' + p.nome">✎</a>

        <div class="pet-body compact">
          <div class="alergias" *ngIf="p.alergias?.length">
            <label class="muted">Alergias:</label>
            <div class="alergia-list">
              <span class="chip" *ngFor="let a of p.alergias">{{ a?.nome || a?.nome_alergia || a?.name || a }}</span>
            </div>
          </div>
        </div>
      </article>
    </section>

    <div class="paginacao acoes">
      <a class="btn" routerLink="/novo-pet">+ Novo Pet</a>
    </div>
  </main>
</div>
